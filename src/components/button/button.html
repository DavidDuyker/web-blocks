<template id="wc-button-template">
  <style>
    /* CSS Variables */
    :host {
      --hover-corners: #007bff;
    }

    .button-link {
      display: inline-block;
      color: var(--color-primary, #007bff);
      text-decoration: underline;
      text-decoration-color: var(--color-primary, #007bff);
      text-underline-offset: 2px;
      text-decoration-thickness: 2px;
      font-family: var(--font-sans, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);
      font-weight: 500;
      font-size: 14px;
      line-height: 1.4;
      cursor: pointer;
      transition: all 0.2s ease;
      position: relative;
      user-select: none;
      white-space: nowrap;
      background: none;
      border: none;
      padding: 0;
    }


div:hover .CornerLinesWrapper,
div:focus .CornerLinesWrapper {
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 1;
}

    .button-link:hover,
    .button-link:focus {
      color: var(--color-primary-hover, #0056b3);
      text-decoration-color: var(--color-primary-hover, #0056b3);
      text-decoration-thickness: 1px;
      outline: none;
    }

    .button-link:active {
      transform: translateY(1px);
    }

    .button-link:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Corner lines effect */
    .CornerLinesWrapper {
      position: absolute;
      top: -2px;
      left: -2px;
      width: calc(100% + 4px);
      height: calc(100% + 4px);
      pointer-events: none;
      opacity: 0;
      transition-duration: 350ms;
    }

    @media (width < 25rem) {
      .CornerLinesWrapper {
        display: none;
      }
    }

    .button-link:hover .CornerLinesWrapper,
    .button-link:focus .CornerLinesWrapper {
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 1;
    }

    .CornerLinesWrapper span {
      position: absolute;
      border: solid 1px var(--hover-corners);
      width: 8px;
      height: 8px;
    }

    .CornerLinesTopLeft {
      top: -1px;
      left: -1px;
      border-bottom: none;
      border-right: none;
      border-top-left-radius: 4px;
    }

    .CornerLinesTopRight {
      top: -1px;
      right: -1px;
      border-bottom: none;
      border-left: none;
      border-top-right-radius: 4px;
    }

    .CornerLinesBottomLeft {
      bottom: -1px;
      left: -1px;
      border-top: none;
      border-right: none;
      border-bottom-left-radius: 4px;
    }

    .CornerLinesBottomRight {
      bottom: -1px;
      right: -1px;
      border-top: none;
      border-left: none;
      border-bottom-right-radius: 4px;
    }
  </style>
  <a class="button-link">
    <slot></slot>
  </a>
</template>

<script>
class WcButton extends HTMLElement {
  static get observedAttributes() {
    return ['disabled', 'href', 'target'];
  }

  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
    this.shadowRoot.appendChild(
      document.getElementById('wc-button-template').content.cloneNode(true)
    );
  }

  connectedCallback() {
    this.updateButton();
    this.setupEventListeners();
    this.setupCornerLines();
  }

  attributeChangedCallback() {
    this.updateButton();
  }

  updateButton() {
    const link = this.shadowRoot.querySelector('.button-link');
    const disabled = this.hasAttribute('disabled');
    const href = this.getAttribute('href');
    const target = this.getAttribute('target');

    // Build classes
    const classes = ['button-link'];
    
    if (disabled) {
      classes.push('button-link--disabled');
    }

    link.className = classes.join(' ');
    
    // Set href and target if provided
    if (href) {
      link.href = href;
    }
    if (target) {
      link.target = target;
    }
  }

  setupEventListeners() {
    const link = this.shadowRoot.querySelector('.button-link');
    
    // Handle click events
    link.addEventListener('click', (e) => {
      if (this.hasAttribute('disabled')) {
        e.preventDefault();
        return;
      }
      
      // Dispatch custom event
      this.dispatchEvent(new CustomEvent('wc-button-click', {
        detail: { originalEvent: e },
        bubbles: true
      }));
    });
  }

  setupCornerLines() {
    const link = this.shadowRoot.querySelector('.button-link');
    
    // Create the wrapper div
    const wrapper = document.createElement('div');
    wrapper.className = 'CornerLinesWrapper';
    
    // Create the corner spans
    const topLeft = document.createElement('span');
    topLeft.className = 'CornerLinesTopLeft';
    
    const topRight = document.createElement('span');
    topRight.className = 'CornerLinesTopRight';
    
    const bottomLeft = document.createElement('span');
    bottomLeft.className = 'CornerLinesBottomLeft';
    
    const bottomRight = document.createElement('span');
    bottomRight.className = 'CornerLinesBottomRight';
    
    // Add all elements to the wrapper
    wrapper.appendChild(topLeft);
    wrapper.appendChild(topRight);
    wrapper.appendChild(bottomLeft);
    wrapper.appendChild(bottomRight);
    
    // Add the wrapper to the link
    link.appendChild(wrapper);
  }

  // Public methods
  setDisabled(disabled) {
    if (disabled) {
      this.setAttribute('disabled', '');
    } else {
      this.removeAttribute('disabled');
    }
  }
}

customElements.define('wc-button', WcButton);
</script>